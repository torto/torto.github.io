!function(){"use strict";angular.module("conta-azul",["ngRoute"]).config(["$routeProvider","$locationProvider",function($routeProvider,$locationProvider){$locationProvider.html5Mode(!0),$routeProvider.when("/",{templateUrl:"partials/index.html",controller:"IndexController"}),$routeProvider.when("/register/car",{templateUrl:"partials/register-car/register-car.html",controller:"RegisterCarController"}),$routeProvider.when("/alter/car",{templateUrl:"partials/register-car/register-car.html",controller:"RegisterCarController"}),$routeProvider.otherwise({redirectTo:"/"})}])}(),angular.module("conta-azul").controller("IndexController",["$scope","ListCarService","$q","$location",function($scope,ListCarService,$q,$location){function updateList(){var newArray=$scope.listCar.list.filter($scope.filterCars);$scope.listCar.filtered=newArray,$scope.listCar.totalPages=Math.ceil($scope.listCar.filtered.length/$scope.listCar.pageSize),$scope.listCar.currentPage=0}$scope.listCar={list:[],labels:[],search:{marca:"",modelo:""},pageSize:5,currentPage:0},$scope.setListPosition=function(position){$scope.listCar.currentPage=position},$scope.removeCar=function(){for(var remove=[],i=0;i<$scope.listCar.itemSelect.length;i++){var method=ListCarService.removeCar($scope.listCar.itemSelect[i]).then(function(value){console.log("removeu"+i)});remove.push(method)}var update=ListCarService.getAllListCar().then(function(values){$scope.listCar.list=values,$scope.listCar.itemSelect=[],$scope.listCar.fullSelect=!1,updateList()});remove.push(update),$q.all(remove)},$scope.$watch("listCar.search",function(newVal,oldVal){updateList()},!0),$scope.filterCars=function(item){return-1!==angular.lowercase(item.marca).indexOf(angular.lowercase($scope.listCar.search.marca))||-1!==angular.lowercase(item.modelo).indexOf(angular.lowercase($scope.listCar.search.modelo))?!0:!1},$scope.changeCarPage=function(car){ListCarService.setCarChange(car),$location.path("/alter/car")},ListCarService.getAllListCar().then(function(values){$scope.listCar.list=values}),ListCarService.labelTable(function(labels){$scope.listCar.labels=labels})}]),angular.module("conta-azul").controller("RegisterCarController",["$scope","ListCarService","$location",function($scope,ListCarService,$location){var carAlter=ListCarService.getCarChange();$scope.car={},$scope.car.combustivel="Gasolina",$scope.imagem=null,carAlter.placa&&($scope.car=carAlter),$scope.saveCar=function(){carAlter.placa?ListCarService.removeCar(carAlter).then(function(){ListCarService.addCar($scope.car).then(function(car){$scope.car={},$scope.cleanAlter(),$location.path("/")})}):ListCarService.addCar($scope.car).then(function(car){$scope.car={},$location.path("/")})},$scope.cleanAlter=function(){ListCarService.setCarChange({})}}]),angular.module("conta-azul").factory("ListCarService",["$q",function($q){"use strict";function splitArray(arr,size){for(var arr2=arr.slice(0),arrays=[];arr2.length>0;)arrays.push(arr2.splice(0,size));return arrays}function updateSplit(){arrays=splitArray(listAllCar,5)}var carChange={},listAllCar=[{combustivel:"Flex",imagem:null,marca:"Volkswagem",modelo:"Gol",placa:"FFF-5498",valor:2e4},{combustivel:"Gasolina",imagem:null,marca:"Volkswagem",modelo:"Fox",placa:"FOX-4125",valor:2e4},{combustivel:"Alcool",imagem:"http://2.bp.blogspot.com/_lkkBt-EnhRs/TPDsQPiT1LI/AAAAAAAAIhQ/7irCdCPghlk/s1600/Image00004.jpg",marca:"Volkswagen",modelo:"Fusca",placa:"PAI-4121",valor:2e4}],arrays=[],retorno={labelTable:function(callback){var jsonReturn=[{label:"Placa",value:"placa",size:"col-md-2",require:!0},{label:"Modelo",value:"modelo",size:"col-md-2",require:!0},{label:"Marca",value:"marca",size:"col-md-2",require:!0},{label:"Foto",value:"imagem",size:"col-md-2"},{label:"CombustÃ­vel",value:"combustivel",size:"col-md-2"},{label:"Valor",value:"valor",size:"col-md-2 text-right padding-table"}];callback(jsonReturn)},getAllListCar:function(){updateSplit();var deferred=$q.defer();return arrays?deferred.resolve(listAllCar):deferred.reject(0),deferred.promise},getNumberListCar:function(){updateSplit();var deferred=$q.defer();return arrays?deferred.resolve(arrays.length):deferred.reject(0),deferred.promise},getListCar:function(position){updateSplit();var deferred=$q.defer();if(arrays){var jsonReturn=arrays[position];deferred.resolve(jsonReturn)}else deferred.reject(0);return deferred.promise},addCar:function(car){updateSplit();var deferred=$q.defer();return arrays?(listAllCar.push(car),deferred.resolve(car)):deferred.reject(!1),deferred.promise},removeCar:function(car){updateSplit();var deferred=$q.defer();if(arrays){var index=listAllCar.indexOf(car);index>-1?(listAllCar.splice(index,1),deferred.resolve(!0)):deferred.reject(!1)}else deferred.reject(!1);return deferred.promise},getCar:function(positionList,position){updateSplit();var deferred=$q.defer();return arrays?deferred.resolve(arrays[positionList][position]):deferred.reject(!1),deferred.promise},setCarChange:function(car){carChange=car},getCarChange:function(){return carChange}};return retorno}]),angular.module("conta-azul").directive("headerFixed",[function(){return{restrict:"E",templateUrl:"partials/header/header.html"}}]),angular.module("conta-azul").directive("tableList",[function(){return{restrict:"E",templateUrl:"partials/table-list/table-list.html",scope:{options:"=",pagination:"@",onChangePage:"&",onRemoveItem:"&",onClickItem:"&"},link:function(scope,elem,attrs){scope.pagination?scope.pagination=!0:scope.pagination=!1,$(elem).on("change",'input[type="checkbox"]',function(e){$(this).closest("tr:not(:has(th))").toggleClass("table-select"),e.preventDefault()}),scope.options.fullSelect=!1,scope.$watch("options.fullSelect",function(newValue){$(".checkbox-full").change()}),$(".checkbox-full").on("change",function(e){var tr=null;if($(this).is(":checked")){tr=$(elem).find('.table tr td input[type="checkbox"]:not(:checked)');for(var i=0;i<tr.length;i++)$(tr[i]).attr("checked",!0).prop("checked",!0),$(tr[i]).change()}else{tr=$(elem).find('.table tr td input[type="checkbox"]:checked');for(var j=0;j<tr.length;j++)$(tr[j]).is(":checked")&&($(tr[j]).attr("checked",!1).prop("checked",!1),$(tr[j]).change())}}),$(elem).on("click",".pagination li",function(){for(var tr=$(elem).find('.table tr input[type="checkbox"]:checked'),i=0;i<tr.length;i++)$(tr[i]).attr("checked",!1).change()})},controller:function($scope){$scope.numberOfPages=function(){return Math.ceil($scope.options.list.length/$scope.options.pageSize)},$scope.options.totalPages=$scope.numberOfPages(),$scope.options.itemSelect=[],$scope.selectItemTableDirective=function(value){var index=$scope.options.itemSelect.indexOf(value);-1>=index?$scope.options.itemSelect.push(value):$scope.options.itemSelect.splice(index,1)},$scope.setFullObject=function(list){var valueInit=$scope.options.currentPage*$scope.options.pageSize;if($scope.options.pageSize>$scope.options.list.length)if($scope.options.itemSelect.length<$scope.options.list.length)for(var i=valueInit;i<list.length;i++)$scope.options.itemSelect.push(list[i]);else $scope.options.itemSelect=[];else if($scope.options.itemSelect.length<$scope.options.pageSize)for(var j=valueInit;j<valueInit+$scope.options.pageSize;j++)$scope.options.itemSelect.push(list[j]);else $scope.options.itemSelect=[]},$scope.changePageTableDirective=function(position){position>=0&&position+1<=$scope.options.totalPages&&($scope.options.itemSelect=[],$scope.onChangePage()(position),$scope.options.currentPage=position)}}}}]).filter("range",function(){return function(n){for(var res=[],i=0;n>i;i++)res.push(i);return res}}).filter("startFrom",function(){return function(input,start){return input?(start=+start,input.slice(start)):[]}});