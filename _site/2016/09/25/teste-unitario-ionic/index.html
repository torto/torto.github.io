<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta content="Teste unitário em Ionic - Parte 1" name="title">
    <meta content="Configurar Karma para o Ionic" name="description">
    <meta content="http://torto.github.io/img/unit-test.jpg" name="preview">
    <!-- Open Graph data -->
    <meta content="Teste unitário em Ionic - Parte 1" property="og:title">
    <meta content="Configurar Karma para o Ionic" property="og:description">
    <meta content="http://torto.github.io/2016/09/25/teste-unitario-ionic/" property="og:url">
    <meta content="http://torto.github.io/img/unit-test.jpg" property="og:image">
    <!-- g+ -->
    <meta content="Teste unitário em Ionic - Parte 1" itemprop="name">
    <meta content="Configurar Karma para o Ionic" itemprop="description">
    <meta content="http://torto.github.io/img/unit-test.jpg" itemprop="image">

    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">

    <title>Teste unitário em Ionic - Parte 1 - Torto Blog</title>



    <link rel="canonical" href="http://torto.github.io/2016/09/25/teste-unitario-ionic/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- jQuery -->
    <script src="/js/jquery.min.js "></script>
    <link rel="stylesheet" type="text/css" href="/css/jgallery.min.css" />
     <script type="text/javascript" src="/js/jgallery.min.js"></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63612158-1', 'auto');
  ga('send', 'pageview');

</script>

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Torto Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/about/">Sobre</a>
                </li>
                
                <li>
                    <a href="/contact/">Contato</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/top-ionic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Teste unitário em Ionic - Parte 1</h1>
                    
                    <h2 class="subheading">Configurar Karma para o Ionic</h2>
                    
                    <span class="meta">Posted by Torto on September 25, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h3 id="introduo">Introdução</h3>

<p>Sei que muita gente tem dificuldades com testes unitário, pensando isso resolvi fazer alguns posts falando um pouco sobre isso. Sei que muita gente utiliza Ionic para desenvolver suas aplicações, nesse post vou ensinar você a configurar o Karma com Jasmine para que possa rodar seus testes unitários maravilhosos &lt;3</p>

<p>Nós próximos posts falarei um pouco em como testar Controllers, Services e Directivas em AngularJS 1.x, legal que você pode encontrar muito material na internet sobre isso, mas focarei sempre no Cordova/Ionic para ajudar aqueles que estão a iniciar com o esse frame lindo.</p>

<ul>
  <li><strong>Teste unitário em Ionic - Parte 1</strong></li>
  <li>Teste unitário em Ionic - Services - Parte 2</li>
  <li>Teste unitário em Ionic - Controllers - Parte 3</li>
  <li>Teste unitário em Ionic - Directives - Parte 4</li>
</ul>

<p>Caso queira dar uma olhada em como o projeto do teste esta ficando, ou tirar alguma dúvida do cód. completo, esse é o <a href="https://github.com/torto/unit-test-ionic">repositório</a>.</p>

<h3 id="instalar-ioniccordova">Instalar Ionic/Cordova</h3>

<p>Caso você já tenho o Ionic e o projeto criado não é necessários refazer esse processo, vamos instalar o Ionic/Cordova e criar um novo projeto padrão:</p>

<p>Para instalar o Ionic digite isso no seu console:</p>

<blockquote>
  <p># npm install -g cordova ionic</p>
</blockquote>

<blockquote>
  <p>$ ionic start NomeApp tabs</p>
</blockquote>

<blockquote>
  <p>$ cd NomeApp</p>
</blockquote>

<h3 id="configurao-do-karma">Configuração do Karma</h3>

<p>Agora vamos adicionar as seguintes dependências no nosso projeto, lembrando que iremos utilizar o node(npm) para fazer o download dos mesmo.</p>

<ul>
  <li>angular-mocks: Dependência que criar mocks no AngularJS;</li>
  <li>jasmine-core: Dep. de teste Jasmine;</li>
  <li>jasmine-jquery: Dep. que usaremos para carregar Jsons para mockar resultados de banco de dados;</li>
  <li>jquery: Dep. necessária para rodar o jasmine-jquery, caso tenha add no bower do teu projeto, não se faz necessário baixar novamente;</li>
  <li>karma: Dep. que executa os testes do Jasmine;</li>
  <li>karma-coverage: Dep. que vai fazer a análise de onde e a porcentagem que seu teste está cobrindo;</li>
  <li>karma-jasmine: Dep. que faz o link do karma com o Jasmine;</li>
  <li>karma-ng-html2js-preprocessor: Dep. que mock todos os htmls para JS, usaremos quando formos testar directivas;</li>
  <li>karma-phantomjs-launcher: Dep. de executa o karma no PhantomJS, browser que roda no terminal.</li>
</ul>

<p>Para fazer o download basta você executar o seguinte código:</p>

<blockquote>
  <p>npm install –save-dev DEPENDÊNCIA</p>
</blockquote>

<p>Você deverá fazer isso um por um, ou executar isso:</p>

<blockquote>
  <p>npm install –save-dev  angular-mocks jasmine-core jasmine-jquery jquery karma karma-coverage karma-jasmine karma-ng-html2js-preprocessor karma-phantomjs-launcher</p>
</blockquote>

<p>Feito agora vamos adicionar o arquivo de configuração do karma (karma.config.js):</p>

<script src="//pastebin.com/embed_js/N4RutJne"></script>

<p>Vamos agora entender o que esse arquivo faz, primeiro é nesse arquivo que configuraremos como nosso karma irá funcionar.</p>

<ul>
  <li>basePath:  Seta qual o caminho base dos nossos diretórios;</li>
  <li>frameworks: Seta quais os frames que utilizaremos para o teste, no caso usaremos jasmine;</li>
  <li>files: Seta quais os arquivos que serão carregados pelo karma para rodar os testes, lembre-se que aqui deve adicionar todas as dependências utilizadas no seu sistema;</li>
  <li>ngHtml2JsPreprocessor: Configuração do plugin que transforma todo html em js para que possamos testar as directives;</li>
  <li>exclude: Seta os arquivos que não devem ser carregados pelo karma;</li>
  <li>preprocessors: Seta no karma os plugins que iremos utilizar;</li>
  <li>reporters: Seta quais os relatórios o karma ira utilizar;</li>
  <li>port: Seta qual a porta que utilizaremos para rodar o karma;</li>
  <li>colors: Seta se o console terá cor;</li>
  <li>logLevel: Seta qual o tipo de log que exibira no terminal;</li>
  <li>autoWatch: Seta se o a cada alteração no teu cód. o karma execute novamente os testes;</li>
  <li>browsers: Seta os browser que executaram o teste;</li>
  <li>singleRun: Seta se os testes executará uma única vez.</li>
</ul>

<p>Agora como setado no arquivo de configuração, todos os arquivos de testes, estarão na pasta “test”, e todos eles devem terminar com a palavra “Test.js” (IndexControllerTest.js), como o Ionic não cria essa pasta, vá na pasta raiz do seu projeto e crie ela.</p>

<h3 id="configurao-do-gulp">Configuração do Gulp</h3>

<p>Agora vamos configurar o gulp para que execute seus testes, é super simples, vamos abrir o arquivos gulpfile.js e adicionar a dependência do karma para o gulp, para isso é só fazer o require do karma:</p>

<p><code class="highlighter-rouge">var Server = require('karma').Server;</code></p>

<p>Depois disso vamos criar a task “test” e executar o karma:</p>

<p><code class="highlighter-rouge">gulp.task('test', function(done) {
  new Server({
    configFile: __dirname + '/karma.config.js'
  }, done).start();
});</code></p>

<p>Salve o arquivo e estamos prontos para executar os nossos testes. Para testarmos se tudo esta certinho, basta executar:</p>

<blockquote>
  <p>$ gulp test</p>
</blockquote>

<p>E pronto seus testes irão executar :D Até a próx.</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2015/09/10/hack-day/" data-toggle="tooltip" data-placement="top" title="HackDay do Grupo Hacker PatoLivre">&larr; Previous Post</a>
                    </li>
                    
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/tortoyo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/tortoyo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/torto">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Torto Blog 2016</p>
            </div>
        </div>
    </div>
</footer>



<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
